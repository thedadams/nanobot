import"../chunks/DsnmJJEf.js";import{p as k,d as v,f as h,g as m,c as M,i as d,j as _,k as x,l as F,m as w,a as S,b as C,h as I,s as R,t as U,$ as b}from"../chunks/TV9P7kG6.js";import{i as y}from"../chunks/DJGld0fm.js";import{C as j}from"../chunks/Czs1io1a.js";import{p as f}from"../chunks/DeFCUsHV.js";import{j as E,k as T,M as D,T as L}from"../chunks/Ce7q_7-7.js";import{g as N}from"../chunks/CnB9Cxot.js";var W=x('<div class="workspace peer m-3 h-[60vh] border-2 border-base-100/30 md:m-0 md:h-dvh md:max-h-dvh md:w-3/4"><!></div>');function $(u,n){k(n,!0);let e=_(()=>{for(const t of n.messages.toReversed())for(const r of(t.items??[]).toReversed())if(r.type==="tool"&&r.output&&r.output?.content){for(const a of r.output.content.toReversed())if(E(a)&&a.resource._meta?.["ai.nanobot.meta/workspace"])return a}return null}),c=_(()=>d(e)?.resource?.text??d(e)?.resource?.blob??"");var s=v(),g=h(s);{var l=t=>{var r=v(),a=h(r);T(a,()=>d(c),p=>{var i=W(),o=F(i);D(o,{get item(){return d(e)},get onSend(){return n.onSendMessage}}),w(i),m(p,i)}),m(t,r)};y(g,t=>{d(c)&&t(l)})}m(u,s),M()}var q=x('<div class="grid grid-cols-1 md:flex md:flex-row"><!> <!></div>');function O(u,n){k(n,!0);const e=f.data.chat||new j,c=N();S(()=>{f.params.id&&e.setChatId(f.params.id).catch(t=>{console.error("Error setting chat ID:",t),c.error(t.message)})}),C(()=>{e.close()});var s=q();I(t=>{var r=v(),a=h(r);{var p=o=>{U(()=>b.title=e.agent.name)},i=o=>{b.title="Nanobot"};y(a,o=>{e.agent?.name?o(p):o(i,!1)})}m(t,r)});var g=F(s);$(g,{get messages(){return e.messages},get onSendMessage(){return e.sendMessage}});var l=R(g,2);L(l,{get messages(){return e.messages},get isLoading(){return e.isLoading},get onFileUpload(){return e.uploadFile},get onSendMessage(){return e.sendMessage},get cancelUpload(){return e.cancelUpload},get prompts(){return e.prompts},get resources(){return e.resources},get elicitations(){return e.elicitations},get agent(){return e.agent},get uploadingFiles(){return e.uploadingFiles},get uploadedFiles(){return e.uploadedFiles},get onElicitationResult(){return e.replyToElicitation}}),w(s),m(u,s),M()}export{O as component};
